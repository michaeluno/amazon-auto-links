/**
	Amazon Auto Links v4.3.0b07 by miunosoft (Michael Uno) 
	Generates links of Amazon products just coming out today. You just pick categories and they appear even in JavaScript disabled browsers.
	<http://en.michaeluno.jp/amazon-auto-links>
	Copyright (c) 2013-2020, Michael Uno; Licensed under GPL v2 or later */
(function($){$(document).ready(function(){ajaxManager.run();$('.aal-tests').click(function(event){event.preventDefault();$('.item-select-error').remove();var _oCheckedTags=$('input.test-tags:checked');if(!_oCheckedTags.length){$(this).parent().parent().append('<span class="item-select-error">* Please select items.</span>');return false};_oCheckedTags.each(function(){var _sLabel=$(this).closest('label').text();if('undefined'===typeof aalTests.files[_sLabel]){console.error('Files for '+_sLabel+' could not be found.');return true};$('*[class*="'+_sLabel+'"]').remove();var _oSection=$('<div class="'+_sLabel+'"></div>');$('.results').append(_oSection);_oSection.accordion({collapsible:true,active:false,heightStyle:"content"});var _aFiles=aalTests.files[_sLabel];$.each(_aFiles,function(index,sFilePath){___testFile(_sLabel,sFilePath)})});return false})
function ___testFile(sLabel,sFilePath){var _oStartButton=$('.aal-tests');ajaxManager.addRequest({type:"post",dataType:'json',async:true,url:aalTests.ajaxURL,data:{action:aalTests.actionHookSuffix,aal_nonce:aalTests.nonce,file_path:sFilePath},spinnerImage:$('<img src="'+aalTests.spinnerURL+'" />'),startButton:_oStartButton,buttonLabel:_oStartButton.val(),resultsArea:$('*[class*="'+sLabel+'"]'),beforeSend:function(){this.spinnerImage.css({'vertical-align':'middle',display:'inline-block',height:'auto','margin-left':'0.5em'});this.startButton.val('Running...');this.startButton.parent().parent().append(this.spinnerImage)},success:function(response){___setResponseOutput(this.resultsArea,response,sFilePath)},error:function(response){this.resultsArea.append('<div class="response-error"><span class="bold error">ERROR</span> '+response.responseText+'</div>')},complete:function(self){self.startButton.val(self.buttonLabel);self.spinnerImage.remove();$('*[class*="'+sLabel+'"]').accordion('refresh')}})}
function ___setResponseOutput(_oTestTag,response,sFilePath){if(!response.success){_oTestTag.append('<p class="test-error"><span class="bold">ERROR</span> '+response.result+'</p>');return};$.each(response.result,function(sIndex,eachResult){var _sHeader='',_sCurrentItem='<p>File: '+sFilePath+'</p>',_sDetails='',_sPurpose='';if(eachResult.success){_sHeader='<h4 class="test-item-header"><span class="test-success bold">OK</span> '+eachResult.name+'</h4>';_sPurpose=eachResult.purpose?'<p class="purpose">'+eachResult.purpose+'</p>':'';_sDetails=eachResult.raw?eachResult.message:eachResult.message?'<p class="">'+eachResult.message+'</p>':''}else{_sHeader='<h4 class="test-item-header"><span class="test-error bold">Failed</span> '+eachResult.name+'</h4>';_sPurpose=eachResult.purpose?'<p class="purpose">'+eachResult.purpose+'</p>':'';_sDetails=eachResult.raw?eachResult.message:eachResult.message?'<p class="">'+eachResult.message+'</p>':''};var _sBody="<div class='result-body'>"+_sPurpose+_sDetails+_sCurrentItem+"</div>";_oTestTag.append(_sHeader+_sBody)})}});var ajaxManager=(function(){var requests=[];return{addRequest:function(opt){requests.push(opt)},removeRequest:function(opt){if($.inArray(opt,requests)>-1)requests.splice($.inArray(opt,requests),1)},run:function(){var self=this,oriSuc;if(requests.length){oriSuc=requests[0].complete;requests[0].complete=function(){if(typeof oriSuc==='function')oriSuc(requests[0]);requests.shift();self.run.apply(self,[])};$.ajax(requests[0])}else self.tid=setTimeout(function(){self.run.apply(self,[])},1e3)},stop:function(){requests=[];clearTimeout(this.tid)}}}())}(jQuery))