/* Plugin Tests 1.0.0 */
(function($){$(document).ready(function(){ajaxManager.run();$('.aal-tests').click(function(event){event.preventDefault();$('.item-select-error').remove();var _aTags=$('.test-tags').val().split(/,\s*/).filter(item=>item);var _oCheckedItems=$('input.test-categories:checked');if(!_oCheckedItems.length){$(this).parent().parent().append('<span class="item-select-error">* Please select items.</span>');return false;}
_oCheckedItems.each(function(){var _sLabel=$(this).closest('label').text();if('undefined'===typeof aalTests.files[_sLabel]){console.error('Files for '+_sLabel+' could not be found.');return true;}
$('*[class*="'+_sLabel+'"]').remove();var _oSection=$('<div class="'+_sLabel+'"></div>');$('.results').append(_oSection);_oSection.accordion({collapsible:true,active:false,heightStyle:"content"});var _aFiles=aalTests.files[_sLabel];$.each(_aFiles,function(index,sFilePath){___runFile(_sLabel,sFilePath,_aTags);});});return false;});function ___runFile(sLabel,sFilePath,aTags){var _oStartButton=$('.aal-tests');ajaxManager.addRequest({type:"post",dataType:'json',async:true,url:aalTests.ajaxURL,data:{action:aalTests.actionHookSuffix,aal_nonce:aalTests.nonce,file_path:sFilePath,tags:aTags,},spinnerImage:$('<img src="'+aalTests.spinnerURL+'" alt="Running..." />'),startButton:_oStartButton,buttonLabel:_oStartButton.val(),resultsArea:$('*[class*="'+sLabel+'"]'),beforeSend:function(){this.spinnerImage.css({'vertical-align':'middle','display':'inline-block','height':'auto','margin-left':'0.5em'});this.startButton.val('Running...');this.startButton.parent().parent().append(this.spinnerImage);},success:function(response){___setResponseOutput(this.resultsArea,response,sFilePath);},error:function(response){this.resultsArea.append('<div class="response-error">'
+'<span class="bold error">ERROR</span> '
+response.responseText
+'</div>');},complete:function(self){self.startButton.val(self.buttonLabel);self.spinnerImage.remove();$('*[class*="'+sLabel+'"]').accordion('refresh');}});}
function ___setResponseOutput(_oTestTag,response,sFilePath){if(!response.success){_oTestTag.append('<p class="test-error">'
+'<span class="bold">ERROR</span> '
+response.result
+'</p>');return;}
$.each(response.result,function(sIndex,eachResult){var _sHeader='';var _sCurrentItem='<p>File: '+sFilePath+'</p>';var _sDetails='';var _sPurpose='';if(eachResult.success){_sHeader='<h4 class="test-item-header">'
+'<span class="test-success bold">OK</span> '
+eachResult.name
+'</h4>';_sPurpose=eachResult.purpose?'<p class="purpose">'+eachResult.purpose+'</p>':'';_sDetails=eachResult.raw?eachResult.message:eachResult.message?'<p class="">'+eachResult.message+'</p>':'';}else{_sHeader='<h4 class="test-item-header">'
+'<span class="test-error bold">Failed</span> '
+eachResult.name
+'</h4>';_sPurpose=eachResult.purpose?'<p class="purpose">'+eachResult.purpose+'</p>':'';_sDetails=eachResult.raw?eachResult.message:eachResult.message?'<p class="">'+eachResult.message+'</p>':'';}
var _sBody="<div class='result-body'>"+_sPurpose+_sDetails+_sCurrentItem+"</div>";_oTestTag.append(_sHeader+_sBody);});}});var ajaxManager=(function(){var requests=[];return{addRequest:function(opt){requests.push(opt);},removeRequest:function(opt){if($.inArray(opt,requests)>-1)
requests.splice($.inArray(opt,requests),1);},run:function(){var self=this,oriSuc;if(requests.length){oriSuc=requests[0].complete;requests[0].complete=function(){if(typeof(oriSuc)==='function'){oriSuc(requests[0]);}
requests.shift();self.run.apply(self,[]);};$.ajax(requests[0]);}else{self.tid=setTimeout(function(){self.run.apply(self,[]);},1000);}},stop:function(){requests=[];clearTimeout(this.tid);}};}());}(jQuery));;