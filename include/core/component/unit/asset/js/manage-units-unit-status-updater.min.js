/* Manage Unit - Unit Status Updater 1.0.0 */
(function($){$(document).ready(function(){$('.unit-status.gray').data('countTrial',0);_checkPendingUnitStatus();var _refreshIntervalId=setInterval(_checkPendingUnitStatus,7500);function _checkPendingUnitStatus(){var _oPendingUnits=$('.unit-status.gray');if(!_oPendingUnits.length){clearInterval(_refreshIntervalId);return}
_oPendingUnits.each(function(index,element){if($(element).hasClass('done')){return!0}
$(element).data().countTrial++;if($(element).data('countTrial')>3){$(element).addClass('gray done');return!0}
var _sUnitID=$(element).attr('data-post-id');$(element).removeClass('gray').addClass('loading');jQuery.ajax({type:"post",dataType:'json',url:aalUnitStatusUpdater.ajaxURL,data:{action:'aal_action_update_unit_status',aal_nonce:$('#amazon-auto-links-nonce').val(),units:[_sUnitID]},success:function(response){if(response.success){$.each(response.result,function(sIndex,value){if('normal'===value){$('.unit-status[data-post-id='+sIndex+']').removeClass('loading').addClass('green done');return!0}
if(value){$('.unit-status[data-post-id='+sIndex+']').removeClass('loading').addClass('red done');return!0}})}else{}},complete:function(){if($(element).hasClass('done')){return}
$(element).removeClass('loading').addClass('gray')}})})}})}(jQuery))