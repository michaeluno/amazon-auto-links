/* Button Preview in Unit Definition Page 1.0.2 */
(function($){aalSetButtonPreviewIframeStyle=function(iWidth,iHeight){var _oFrameContainer=$('.iframe-button-preview-container');_oFrameContainer.each(function(){var _oIframe=$(this).find('iframe');_oIframe.width(iWidth).height(iHeight).css({'width':iWidth+'px','height':iHeight+'px','display':'block','margin':'0 auto','transform':'translateZ(0)','min-width':'116px',});_oIframe.contents().find('head').append($("<style type='text/css'>  html, body{ background-color: unset !important; } </style>"));});};$(document).ready(function(){if('undefined'===typeof aalButtonPreview){return false;}
debugLog('Amazon Auto Links Button Preview Script',aalButtonPreview);var _setPreviewButton=function(iButtonID,oSelect){iButtonID=parseInt(iButtonID);var _oButton=oSelect.closest('fieldset').find('.amazon-auto-links-button');if('undefined'===typeof aalButtonPreview.activeButtons[iButtonID]){debugLog.log('the button label does not exist. button ID',iButtonID,'active buttons',aalButtonPreview.activeButtons);return;}
var _oButtonContainer=$(_oButton).parent();var _sButtonLabel=oSelect.closest('.amazon-auto-links-section-table').find('input.override-button-label[type=checkbox]').prop('checked')?oSelect.closest('.amazon-auto-links-section-table').find('input.button-label[type=text]').val():aalButtonPreview.activeButtons[iButtonID];if(iButtonID){$(_oButton).attr('class','amazon-auto-links-button amazon-auto-links-button-'+iButtonID);___setButtonLabel_div(_sButtonLabel,oSelect);_oButtonContainer.show();_oButtonContainer.siblings('.iframe-button-preview-container').css({'position':'absolute','top':'-9999px','z-depth':'-100',});return;}
_oButtonContainer.hide();___setButtonLabel_iframe(_sButtonLabel,oSelect);_oButtonContainer.siblings('.iframe-button-preview-container').css({'position':'static','top':'0','z-depth':'1',});};var _oButtonSelect=$('.button-select-row').find('select');_oButtonSelect.on('change',function(){_setPreviewButton($(this).val(),$(this));});_oButtonSelect.trigger('change');$('input.override-button-label[type=checkbox]').on('change',function(){if(!$(this).prop('checked')){___revertButtonLabels(_oButtonSelect);return;}
___setButtonLabelByInput($(this).closest('.amazon-auto-links-section-table').find('input.button-label[type=text]').first());});$('input.button-label[type=text]').on('change',function(){var _oOverrideLabel=$(this).closest('.amazon-auto-links-section-table').find('input.override-button-label[type=checkbox]');if(!_oOverrideLabel.prop('checked')){return;}
___setButtonLabelByInput(this);});$('.iframe-button-preview-container').find('iframe').on('load',function(){$('input.override-button-label[type=checkbox]').trigger('change');});function ___revertButtonLabels(oButtonSelect){___setButtonLabel_iframe(aalButtonPreview.activeButtons[0],oButtonSelect);var _iButtonID=parseInt(oButtonSelect.val());if(_iButtonID&&aalButtonPreview.activeButtons[_iButtonID]){___setButtonLabel_div(aalButtonPreview.activeButtons[_iButtonID],oButtonSelect);return;}
$.each(aalButtonPreview.activeButtons,function(__iButtonID,__sButtonLabel){if(0===__iButtonID){return true;}
___setButtonLabel_div(__sButtonLabel,oButtonSelect);return false;});}
function ___setButtonLabelByInput(oButtonLabelInput){if('undefined'===typeof oButtonLabelInput){return;}
___setButtonLabel($(oButtonLabelInput).val(),oButtonLabelInput);}
function ___setButtonLabel(sLabel,oElem){___setButtonLabel_div(sLabel,oElem);___setButtonLabel_iframe(sLabel,oElem);}
function ___setButtonLabel_div(sLabel,oElem){$(oElem).closest('.amazon-auto-links-section-table').find('.amazon-auto-links-button').text(sLabel);}
function ___setButtonLabel_iframe(sLabel,oElem){var _oButton=$(oElem).closest('.amazon-auto-links-section-table').find('iframe').contents().find('button.amazon-auto-links-button');_oButton.text(sLabel);if('undefined'===typeof _oButton[0]){return;}
if('undefined'===typeof _oButton[0].offsetWidth){return;}
aalSetButtonPreviewIframeStyle(_oButton[0].offsetWidth,_oButton[0].offsetHeight);}});function debugLog(...args){if(!parseInt(aalButtonPreview.debugMode)){return;}
console.log('AAL Debug(Button Preview):',...args);}}(jQuery));;